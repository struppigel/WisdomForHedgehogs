
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Malware analysis blog by struppigel aka Karsten Hahn" name="description"/>
<meta content="Karsten Hahn" name="author"/>
<link href="https://struppigel.github.io/WisdomForHedgehogs/Execution%20Environments/MBR%20and%20BIOS/" rel="canonical"/>
<link href="../CPython%20Bytecode%20Reversing/" rel="prev"/>
<link href="../PowerShell/" rel="next"/>
<link href="../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.4.2, mkdocs-material-9.1.2" name="generator"/>
<title>MBR and BIOS - Malware Analysis For Hedgehogs</title>
<link href="../../assets/stylesheets/main.7bf56d0a.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.a0c5b2b5.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=orbitron:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"orbitron";--md-code-font:"Roboto Mono"}</style>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            
                .gscrollbar-fixer { padding-right: 15px; }
                .gdesc-inner { font-size: 0.75rem; }
                body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
                body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
                body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
                </style><script src="../../assets/javascripts/glightbox.min.js"></script></head>
<body data-md-color-accent="yellow" data-md-color-primary="black" data-md-color-scheme="slate" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#static-mbr-analysis">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Malware Analysis For Hedgehogs" class="md-header__button md-logo" data-md-component="logo" href="../.." title="Malware Analysis For Hedgehogs">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 .5a1.746 1.746 0 0 0-1 3.18v1.4c-.9.13-1.74.42-2.5.86L7.39 4.35c.19-.52.14-1.12-.2-1.6C6.84 2.26 6.3 2 5.75 2c-.35 0-.7.1-1 .32-.79.55-.99 1.64-.43 2.43.34.49.88.75 1.43.75l1.18 1.68c-.43.43-.77.91-1.06 1.44-.2-.08-.41-.12-.62-.12-.45 0-.9.17-1.25.5-.67.7-.67 1.8 0 2.5.29.27.64.42 1 .5 0 .54.07 1.06.18 1.56l-1.31.35c-.31-.26-.71-.41-1.12-.41-.15 0-.31 0-.46.06a1.752 1.752 0 0 0-1.23 2.15C1.27 16.5 2 17 2.75 17c.15 0 .3 0 .46-.06.57-.16 1-.58 1.18-1.1l1.51-.41c.45.79 1.05 1.49 1.75 2.07l-1.1 2c-.55.08-1.05.39-1.34.92a1.749 1.749 0 1 0 3.08 1.66c.28-.52.27-1.12.02-1.61l1.07-1.97c.81.32 1.69.5 2.62.5h.18c-.13.26-.18.56-.18.88.08.92.84 1.62 1.75 1.62h.13c.97-.08 1.69-.92 1.62-1.88-.04-.5-.29-.94-.65-1.23.47-.21.92-.48 1.34-.79l2.34 2.34c-.1.56.06 1.13.47 1.56.35.33.8.5 1.25.5s.9-.17 1.25-.5c.67-.7.67-1.8 0-2.5-.35-.33-.8-.5-1.25-.5-.1 0-.2 0-.31.03l-2.34-2.34c.49-.65.87-1.39 1.11-2.19h1.11A1.746 1.746 0 0 0 23 13a1.746 1.746 0 0 0-3.18-1H19c0-1.57-.5-3-1.4-4.19l1.34-1.34c.11.03.21.03.31.03.45 0 .9-.17 1.25-.5.67-.69.67-1.8 0-2.5-.35-.33-.8-.5-1.25-.5s-.9.17-1.25.5c-.41.43-.57 1-.47 1.56L16.19 6.4c-.92-.69-2-1.15-3.19-1.32v-1.4A1.746 1.746 0 0 0 12 .5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m-1.5-8C9.67 9 9 9.67 9 10.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5S11.33 9 10.5 9m3.5 4c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1Z"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Malware Analysis For Hedgehogs
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              MBR and BIOS
            
          </span>
</div>
</div>
</div>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/struppigel/WisdomForHedgehogs" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    Github
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Malware Analysis For Hedgehogs" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="Malware Analysis For Hedgehogs">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 .5a1.746 1.746 0 0 0-1 3.18v1.4c-.9.13-1.74.42-2.5.86L7.39 4.35c.19-.52.14-1.12-.2-1.6C6.84 2.26 6.3 2 5.75 2c-.35 0-.7.1-1 .32-.79.55-.99 1.64-.43 2.43.34.49.88.75 1.43.75l1.18 1.68c-.43.43-.77.91-1.06 1.44-.2-.08-.41-.12-.62-.12-.45 0-.9.17-1.25.5-.67.7-.67 1.8 0 2.5.29.27.64.42 1 .5 0 .54.07 1.06.18 1.56l-1.31.35c-.31-.26-.71-.41-1.12-.41-.15 0-.31 0-.46.06a1.752 1.752 0 0 0-1.23 2.15C1.27 16.5 2 17 2.75 17c.15 0 .3 0 .46-.06.57-.16 1-.58 1.18-1.1l1.51-.41c.45.79 1.05 1.49 1.75 2.07l-1.1 2c-.55.08-1.05.39-1.34.92a1.749 1.749 0 1 0 3.08 1.66c.28-.52.27-1.12.02-1.61l1.07-1.97c.81.32 1.69.5 2.62.5h.18c-.13.26-.18.56-.18.88.08.92.84 1.62 1.75 1.62h.13c.97-.08 1.69-.92 1.62-1.88-.04-.5-.29-.94-.65-1.23.47-.21.92-.48 1.34-.79l2.34 2.34c-.1.56.06 1.13.47 1.56.35.33.8.5 1.25.5s.9-.17 1.25-.5c.67-.7.67-1.8 0-2.5-.35-.33-.8-.5-1.25-.5-.1 0-.2 0-.31.03l-2.34-2.34c.49-.65.87-1.39 1.11-2.19h1.11A1.746 1.746 0 0 0 23 13a1.746 1.746 0 0 0-3.18-1H19c0-1.57-.5-3-1.4-4.19l1.34-1.34c.11.03.21.03.31.03.45 0 .9-.17 1.25-.5.67-.69.67-1.8 0-2.5-.35-.33-.8-.5-1.25-.5s-.9.17-1.25.5c-.41.43-.57 1-.47 1.56L16.19 6.4c-.92-.69-2-1.15-3.19-1.32v-1.4A1.746 1.746 0 0 0 12 .5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m-1.5-8C9.67 9 9 9.67 9 10.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5S11.33 9 10.5 9m3.5 4c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1Z"></path></svg>
</a>
    Malware Analysis For Hedgehogs
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/struppigel/WisdomForHedgehogs" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    Github
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../..">
        Wisdom for Hedgehogs
      </a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Reversing Tips
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
          Reversing Tips
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../CPython%20Bytecode%20Reversing/">
        CPython Bytecode
      </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          MBR and BIOS
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        MBR and BIOS
      </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#static-mbr-analysis">
    Static MBR Analysis
  </a>
<nav aria-label="Static MBR Analysis" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#useful-assembly-snippets-and-values-to-recognize">
    Useful assembly snippets and values to recognize
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#common-int-13-commands">
    Common Int 13 commands
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#dynamic-analysis">
    Dynamic Analysis
  </a>
<nav aria-label="Dynamic Analysis" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#configuration-via-bochsrcbxrc">
    Configuration via bochsrc.bxrc
  </a>
<nav aria-label="Configuration via bochsrc.bxrc" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#explanation">
    Explanation
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#creating-the-disk-image">
    Creating the disk image
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#infecting-the-disk-image">
    Infecting the disk image
  </a>
<nav aria-label="Infecting the disk image" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#1-install-guest-os-on-bochs-and-execute-bootkit-infector">
    1. Install guest OS on Bochs and execute bootkit infector
  </a>
<nav aria-label="1. Install guest OS on Bochs and execute bootkit infector" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#pros">
    pros
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#cons">
    cons
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-extract-bootkit-components-mbr-vbr-ipl-and-write-to-disk-image">
    2. Extract bootkit components (MBR, VBR, IPL) and write to disk image
  </a>
<nav aria-label="2. Extract bootkit components (MBR, VBR, IPL) and write to disk image" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#pros_1">
    pros
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#cons_1">
    cons
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#howto">
    howto
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#3-infect-vm-and-copy-paste-bootkit-data">
    3. Infect VM and copy-paste bootkit data
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#debugging-the-disk-image">
    Debugging the disk image
  </a>
<nav aria-label="Debugging the disk image" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#via-bochs">
    Via Bochs
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#via-bochs-with-ida">
    Via Bochs with IDA
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#resources">
    Resources
  </a>
<nav aria-label="Resources" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#learning">
    Learning
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#documentation">
    Documentation
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../PowerShell/">
        PowerShell
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Essays / Guides (GDATA)
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
          Essays / Guides (GDATA)
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="https://www.gdatasoftware.com/blog/2022/09/37511-detecting-file-manipulation-in-system-files">
        Identifying file manipulation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://www.gdatasoftware.com/blog/2022/01/malware-vaccines">
        Malware vaccines
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://www.gdatasoftware.com/blog/2021/09/an-overview-of-malware-hashing-algorithms">
        Hashing algorithms
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://www.gdatasoftware.com/blog/2019/08/35146-taming-the-mess-of-av-detection-names">
        Malware naming - AV detection names
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://www.gdatasoftware.com/blog/malware-family-naming-hell">
        Malware naming hell
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://www.gdatasoftware.com/blog/2016/11/29289-it-s-educational-on-the-no-1-argument-for-open-source-ransomware">
        Open source ransomware
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://www.gdatasoftware.com/blog/2019/06/31666-ransomware-identification-for-the-judicious-analyst">
        Ransomware identification
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://www.gdatasoftware.com/blog/2022/06/37445-malware-detection-is-hard">
        Why malware detection is hard
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Malware Articles (GDATA)
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
          Malware Articles (GDATA)
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="https://www.gdatasoftware.com/blog/2022/02/37239-allcome-clipbanker-is-a-newcomer-in-malware-underground-forums">
        Allcome
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://www.gdatasoftware.com/blog/2020/11/36459-babax-stealer-rebrands-to-osno-installs-rootkit">
        Babax
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://www.gdatasoftware.com/blog/2022/01/37236-qr-codes-on-twitter-deliver-malicious-chrome-extension">
        ChromeLoader / Choziosi
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://www.gdatasoftware.com/blog/2020/02/35802-bitbucket-abused-as-malware-slinger">
        CryptBot
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://www.gdatasoftware.com/blog/cyrat-ransomware">
        Cyrat
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://www.gdatasoftware.com/blog/2019/04/31643-garrantydecrypt-ransomware-spyhunter">
        GarrantyDecrypt
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://www.gdatasoftware.com/blog/2022/03/ginzo-free-malware">
        Ginzo
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://www.gdatasoftware.com/blog/icerat-evades-antivirus-by-using-jphp">
        IceRAT
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://www.gdatasoftware.com/blog/microsoft-signed-a-malicious-netfilter-rootkit">
        Netfilter rootkit
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://www.gdatasoftware.com/blog/netwire-rat-via-pasteee-and-ms-excel">
        NetWireRAT
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://www.gdatasoftware.com/blog/2019/11/35548-new-sectoprat-remote-access-malware-utilizes-second-desktop-to-control-browsers">
        SectopRAT
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://www.gdatasoftware.com/blog/2017/01/29442-spora-worm-and-ransomware">
        Spora
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://www.gdatasoftware.com/blog/2021/06/36861-malware-hides-in-steam-profile-images">
        SteamHide
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://www.gdatasoftware.com/blog/strrat-crimson">
        STRRAT
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://www.gdatasoftware.com/blog/trat-control-via-smartphone">
        T-RAT 2.0
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://www.gdatasoftware.com/blog/2020/07/36200-ransomware-tries-to-worm">
        Try2Cry
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../About%20me/">
        About me
      </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#static-mbr-analysis">
    Static MBR Analysis
  </a>
<nav aria-label="Static MBR Analysis" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#useful-assembly-snippets-and-values-to-recognize">
    Useful assembly snippets and values to recognize
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#common-int-13-commands">
    Common Int 13 commands
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#dynamic-analysis">
    Dynamic Analysis
  </a>
<nav aria-label="Dynamic Analysis" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#configuration-via-bochsrcbxrc">
    Configuration via bochsrc.bxrc
  </a>
<nav aria-label="Configuration via bochsrc.bxrc" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#explanation">
    Explanation
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#creating-the-disk-image">
    Creating the disk image
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#infecting-the-disk-image">
    Infecting the disk image
  </a>
<nav aria-label="Infecting the disk image" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#1-install-guest-os-on-bochs-and-execute-bootkit-infector">
    1. Install guest OS on Bochs and execute bootkit infector
  </a>
<nav aria-label="1. Install guest OS on Bochs and execute bootkit infector" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#pros">
    pros
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#cons">
    cons
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-extract-bootkit-components-mbr-vbr-ipl-and-write-to-disk-image">
    2. Extract bootkit components (MBR, VBR, IPL) and write to disk image
  </a>
<nav aria-label="2. Extract bootkit components (MBR, VBR, IPL) and write to disk image" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#pros_1">
    pros
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#cons_1">
    cons
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#howto">
    howto
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#3-infect-vm-and-copy-paste-bootkit-data">
    3. Infect VM and copy-paste bootkit data
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#debugging-the-disk-image">
    Debugging the disk image
  </a>
<nav aria-label="Debugging the disk image" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#via-bochs">
    Via Bochs
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#via-bochs-with-ida">
    Via Bochs with IDA
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#resources">
    Resources
  </a>
<nav aria-label="Resources" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#learning">
    Learning
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#documentation">
    Documentation
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1>MBR and BIOS</h1>
<div><p>MBR malware is not that common anymore and will decline more with the advent of UEFI. The most notable occurences were MBR ransomware families that were created with a publicly available MBR image builder by WobbyChip and of course Petya.</p>
<p>MBR malware is still one of the most fascinating topics for me and a good starting point if you are interested in UEFI later.</p>
<p>I highly recommend reading the book <a href="https://www.amazon.com/Rootkits-Bootkits-Reversing-Malware-Generation/dp/1593277164">Rootkits and Bootkits, Chapter 8 Static Analysis of a Bootkit using IDA Pro</a> as well as watching Dump-GUY's video <a href="https://www.youtube.com/watch?v=qmhGwvAH7-8">IDAPro Reversing Delphi MBR Wiper and Infected Bootstrap Code</a> </p>
<h2 id="static-mbr-analysis">Static MBR Analysis</h2>
<p>You need to setup your disassembler correctly to analyse MBR code.</p>
<p>Load the file as binary file.
Set the <em>Loading offset</em> for the file to <strong>0x7c00</strong> because this is the fixed address where MBR is loaded.
Choose <em>16-bit mode</em>.</p>
<h3 id="useful-assembly-snippets-and-values-to-recognize">Useful assembly snippets and values to recognize</h3>
<p>I found it very helpful to note down magic numbers and commands that are the most relevant for MBR malware analysis because there is so much potential information that you could learn.</p>
<p>Remember the following ones and it should serve you well.</p>
<table>
<thead>
<tr>
<th>value or code</th>
<th>meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x7c00</td>
<td>Loading offset for MBR code</td>
</tr>
<tr>
<td>512</td>
<td>size of MBR</td>
</tr>
<tr>
<td>dl</td>
<td>BIOS sets dl register to number of harddrive from which MBR is being executed</td>
</tr>
<tr>
<td>sub ptr ds:413h, 10h</td>
<td>16-bit value (x86) located at 413h contains available memory in KB, this needs to be substracted when allocating memory, here 10 KB are substracted</td>
</tr>
<tr>
<td>int 13h</td>
<td>entry point to BIOS disk service, operation code put into <code>ah</code> in the example</td>
</tr>
<tr>
<td>0x1BE or 0x7DBE</td>
<td>Partition Table offset, with 4 entries, 0x10 bytes each, lists available partitions</td>
</tr>
<tr>
<td>0x0AA55(LE) or "55 AA"</td>
<td>Magic number, always last two bytes of first sector in bootdisk, BIOS will only try to boot if this is found</td>
</tr>
</tbody>
</table>
<h3 id="common-int-13-commands">Common Int 13 commands</h3>
<p>Similarly to the snippets the table below lists common commands that will help to understand MBR malware.</p>
<table>
<thead>
<tr>
<th>operation code</th>
<th>description</th>
<th>usage by malware</th>
</tr>
</thead>
<tbody>
<tr>
<td>2h</td>
<td>Read sectors into memory</td>
<td></td>
</tr>
<tr>
<td>3h</td>
<td>Write disk sectors</td>
<td></td>
</tr>
<tr>
<td>8h</td>
<td>Get drive parameters</td>
<td></td>
</tr>
<tr>
<td>41h</td>
<td>Extensions installation check</td>
<td></td>
</tr>
<tr>
<td>42h</td>
<td>Extended read</td>
<td>read malicious boot sector</td>
</tr>
<tr>
<td>43h</td>
<td>Extended write</td>
<td></td>
</tr>
<tr>
<td>48h</td>
<td>Extended get drive parameters</td>
<td>navigate to hidden storage</td>
</tr>
</tbody>
</table>
<details class="info" open="open">
<summary>Info</summary>
<p>Operation codes below 41h are legacy operations.
The adressing scheme for extended operations is called <em>logical block adressing</em> (LBA), legacy operations use <em>Cylinder Head Sector</em> (CHS) based adressing</p>
</details>
<p>There are more commands, see: <a href="https://en.wikipedia.org/wiki/INT_13H">INT_13h Wikipedia</a></p>
<h2 id="dynamic-analysis">Dynamic Analysis</h2>
<p>This is best done using <a href="https://github.com/bochs-emu/Bochs">Bochs</a>, an alternative is <a href="https://www.qemu.org/">QEMU</a>.</p>
<h3 id="configuration-via-bochsrcbxrc">Configuration via bochsrc.bxrc</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a>megs: 512  
</span><span id="__span-0-2"><a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a>romimage: file="../BIOS-bochs-latest"
</span><span id="__span-0-3"><a href="#__codelineno-0-3" id="__codelineno-0-3" name="__codelineno-0-3"></a>vgaromimage: file="../VGABIOS-lgpl-latest"
</span><span id="__span-0-4"><a href="#__codelineno-0-4" id="__codelineno-0-4" name="__codelineno-0-4"></a>boot: cdrom, disk
</span><span id="__span-0-5"><a href="#__codelineno-0-5" id="__codelineno-0-5" name="__codelineno-0-5"></a>ata0-master: type=disk, path="image.img", mode=flat, cylinders=6192, heads=16, spt=63
</span><span id="__span-0-6"><a href="#__codelineno-0-6" id="__codelineno-0-6" name="__codelineno-0-6"></a>mouse: enabled=0
</span><span id="__span-0-7"><a href="#__codelineno-0-7" id="__codelineno-0-7" name="__codelineno-0-7"></a>cpu: ips=90000000
</span></code></pre></div>
<h4 id="explanation">Explanation</h4>
<ul>
<li><em>megs</em>: RAM limit for emulated environment</li>
<li><em>romimage</em> and <em>vgaromimage</em> specify paths to BIOS and VGA BIOS modules (default modules are shipped by Bochs and used here)</li>
<li><em>boot</em>: boot device sequence</li>
<li><em>ata0-master</em>: type and characteristics of harddrive, disk image named "win_os.img" is created with bxImage tool<ul>
<li>type: either disk or cdrom</li>
<li>path: path to disk image on host system</li>
<li>mode: type of image, only valid for disk device</li>
<li>cylinders: number of cylinders on disk (defines size of disk)</li>
<li>heads: number of heads for disk (defines size of disk)</li>
<li>spt: number of sectors per track (defines size of disk)</li>
</ul>
</li>
<li><em>mouse</em>: en- or disables mouse</li>
</ul>
<h3 id="creating-the-disk-image">Creating the disk image</h3>
<p>You can use <em>dd</em> (Unix) or <em>bximage</em> command.</p>
<p><em>bximage</em> is part of bochs. Choose the following options </p>
<ul>
<li>Enter 1 to create a new hard disk image</li>
<li>Choose <em>hd</em></li>
<li>Choose [flat]</li>
<li>Enter 10</li>
<li>Choose any name, e.g., image.img, make sure that the ata0-master path variable is set to this image name in bochsrc.bxrc</li>
</ul>
<p>Now you have a disk image.</p>
<h3 id="infecting-the-disk-image">Infecting the disk image</h3>
<p>There are several ways to do that. The book Rootkits and Bootkits describes the first two. But my preferred one is the last.</p>
<h4 id="1-install-guest-os-on-bochs-and-execute-bootkit-infector">1. Install guest OS on Bochs and execute bootkit infector</h4>
<h5 id="pros">pros</h5>
<ul>
<li>all components of malware are installed</li>
</ul>
<h5 id="cons">cons</h5>
<ul>
<li>emulation of instructions takes longer</li>
<li>needs larger disk image</li>
<li>antiemulation of malware might trigger</li>
</ul>
<h4 id="2-extract-bootkit-components-mbr-vbr-ipl-and-write-to-disk-image">2. Extract bootkit components (MBR, VBR, IPL) and write to disk image</h4>
<h5 id="pros_1">pros</h5>
<ul>
<li>smaller disk size</li>
<li>faster</li>
</ul>
<h5 id="cons_1">cons</h5>
<ul>
<li>cannot analyse components like kernel mode drivers</li>
<li>a little complicated</li>
</ul>
<h5 id="howto">howto</h5>
<ul>
<li>Extract MBR, VBR and IPL</li>
<li>Write MBR to 0x0</li>
<li>Check partition table for active partition: starting sector (e.g. 0x10) and partition size in sectors (e.g. 0x200) are used to compute start of VBR</li>
<li>Write VBR and IPL to active partition offset: starting sector * partition size (e.g. here 0x2000) </li>
</ul>
<h4 id="3-infect-vm-and-copy-paste-bootkit-data">3. Infect VM and copy-paste bootkit data</h4>
<ul>
<li>Infect a VM with bootkit infector</li>
<li>Run 010 Editor as administrator</li>
<li>Go to File --&gt; Open Drive --&gt; Physical Drive C:</li>
<li>Copy and paste data to Bochs image</li>
</ul>
<h3 id="debugging-the-disk-image">Debugging the disk image</h3>
<p>Using IDA with Bochs is the most convenient way to do that. But you can also just use Bochs.</p>
<h4 id="via-bochs">Via Bochs</h4>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a>bochsdbg.exe<span class="w"> </span>-q<span class="w"> </span>-f<span class="w"> </span>bochsrc.bxrc
</span></code></pre></div>
<p>Enter <em>lb 0x7c00</em> to set breakpoint on start of boot code</p>
<p>Press <em>c</em> to commence execution</p>
<p>Press <em>u</em> to see disassembles instruction from current address</p>
<p>Enter <em>help</em> for full list of instructions or visit ðŸ”—<a href="https://bochs.sourceforge.io/doc/docbook/user/internal-debugger.html">Bochs Documentation</a></p>
<h4 id="via-bochs-with-ida">Via Bochs with IDA</h4>
<p>Way 1:</p>
<ul>
<li>start Bochs emulation</li>
<li>In IDA go to Debugger --&gt; Run --&gt; Local Bochs Debugger</li>
<li>in the dialog specify path to Bochs configuration file <em>bochsrc.bxrc</em></li>
<li>click Debug options --&gt; Set specific options<ul>
<li>select Disk image</li>
</ul>
</li>
</ul>
<p>Way 2:</p>
<ul>
<li>open <em>bochsrc.bxrc</em> in IDA as file</li>
</ul>
<h2 id="resources">Resources</h2>
<p>Check out the following resources if you want to dig deeper.</p>
<h3 id="learning">Learning</h3>
<p>ðŸ“˜<a href="https://www.amazon.com/Rootkits-Bootkits-Reversing-Malware-Generation/dp/1593277164">Rootkits and Bootkits, Chapter 8 Static Analysis of a Bootkit using IDA Pro</a></p>
<p>ðŸ“¹<a href="https://www.youtube.com/watch?v=qmhGwvAH7-8">IDAPro Reversing Delphi MBR Wiper and Infected Bootstrap Code</a> </p>
<p>--&gt; companion tutorial: ðŸ”—<a href="https://github.com/Dump-GUY/Malware-analysis-and-Reverse-engineering/blob/main/Debugging%20MBR%20-%20IDA%20+%20Bochs%20Emulator/Debugging%20MBR%20-%20IDA%20+%20Bochs%20Emulator.md">Debugging MBR - IDA + Bochs Emulator (CTF example)</a></p>
<p>ðŸ”—<a href="http://www.blackstormsecurity.com/docs/DC2711.pdf">Alexandre Borges Slides Defcon</a></p>
<p>ðŸ”—<a href="https://exploitreversing.files.wordpress.com/2021/12/hitb_ams_2019-1.pdf">Alexandre Borges Slides 2019 Amsterdam</a></p>
<p>ðŸ”—<a href="https://exploitreversing.files.wordpress.com/2021/12/defcon2018-2.pdf">Alexandre Borges Ring 0 Rootkits</a></p>
<h3 id="documentation">Documentation</h3>
<p>ðŸ”¨<a href="https://github.com/EricZimmerman/MFT">MFT parser</a> </p>
<p>ðŸ”—<a href="https://github.com/libyal/libfsntfs/blob/main/documentation/New%20Technologies%20File%20System%20(NTFS).asciidoc">New Technologies File System (NTFS)</a> by Joachim Metz --&gt; this one is good, more concise</p>
<p>ðŸ”—<a href="https://dubeyko.com/development/FileSystems/NTFS/ntfsdoc.pdf">more NTFS documentation</a></p>
<p>ðŸ”—<a href="https://flatcap.github.io/linux-ntfs/ntfs/">Even more NTFS documentation</a></p></div>
<hr/>
<div class="md-source-file">
<small>
    
      Last update:
      2023-04-04
    
  </small>
</div>
<h2 id="__comments">Comments</h2>
<script async="" crossorigin="anonymous" data-category="General" data-category-id="DIC_kwDOJEee5M4CUzl7" data-emit-metadata="0" data-input-position="top" data-lang="en" data-mapping="pathname" data-reactions-enabled="1" data-repo="struppigel/WisdomForHedgehogs" data-repo-id="R_kgDOJEee5A" data-strict="0" data-theme="dark" src="https://giscus.app/client.js">
</script>
<script>
    var giscus = document.querySelector("script[src*=giscus]")

    /* Set palette on initial load */
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object") {
      var theme = palette.color.scheme === "slate" ? "dark" : "light"
      giscus.setAttribute("data-theme", theme) 


    }

    /* Register event handlers after documented loaded */
    document.addEventListener("DOMContentLoaded", function() {
      var ref = document.querySelector("[data-md-component=palette]")
      ref.addEventListener("change", function() {
        var palette = __md_get("__palette")
        if (palette && typeof palette.color === "object") {
          var theme = palette.color.scheme === "slate" ? "dark" : "light"

          /* Instruct Giscus to change theme */
          var frame = document.querySelector(".giscus-frame")
          frame.contentWindow.postMessage(
            { giscus: { setConfig: { theme } } },
            "https://giscus.app"
          )
        }
      })
    })
  </script>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
      Karsten Hahn
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
<div class="md-social">
<a class="md-social__link" href="https://infosec.exchange/@struppigel" rel="noopener me" target="_blank" title="infosec.exchange">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48 0 0 0-63.72 28.5-63.72 125.7 0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54 0 0 1-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"></path></svg>
</a>
<a class="md-social__link" href="https://twitter.com/struppigel" rel="noopener" target="_blank" title="twitter.com">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg>
</a>
<a class="md-social__link" href="https://www.youtube.com/@MalwareAnalysisForHedgehogs" rel="noopener" target="_blank" title="www.youtube.com">
<svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"></path></svg>
</a>
<a class="md-social__link" href="https://github.com/struppigel" rel="noopener" target="_blank" title="github.com">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy"], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../../assets/javascripts/bundle.fc8c2696.min.js"></script>
<script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>